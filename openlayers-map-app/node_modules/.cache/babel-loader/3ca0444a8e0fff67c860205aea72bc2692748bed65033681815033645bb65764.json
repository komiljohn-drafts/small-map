{"ast":null,"code":"/**\n * @module ol/render/canvas/ZIndexContext\n */\n\nimport { getSharedCanvasContext2D } from '../../dom.js';\n\n/** @typedef {CanvasRenderingContext2D & {globalAlpha: any}} ZIndexContextProxy */\n\n/**\n * @extends {CanvasRenderingContext2D}\n */\nclass ZIndexContext {\n  constructor() {\n    /**\n     * @private\n     * @type {Array<Array<*>>}\n     */\n    this.instructions_ = [];\n    /**\n     * @type {number}\n     */\n    this.zIndex = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n    this.offset_ = 0;\n\n    /**\n     * @private\n     * @type {ZIndexContextProxy}\n     */\n    this.context_ = /** @type {ZIndexContextProxy} */\n    new Proxy(getSharedCanvasContext2D(), {\n      get: (target, property) => {\n        if (typeof (/** @type {*} */getSharedCanvasContext2D()[property]) !== 'function') {\n          // we only accept calling functions on the proxy, not accessing properties\n          return undefined;\n        }\n        if (!this.instructions_[this.zIndex + this.offset_]) {\n          this.instructions_[this.zIndex + this.offset_] = [];\n        }\n        this.instructions_[this.zIndex + this.offset_].push(property);\n        return this.pushMethodArgs_;\n      },\n      set: (target, property, value) => {\n        if (!this.instructions_[this.zIndex + this.offset_]) {\n          this.instructions_[this.zIndex + this.offset_] = [];\n        }\n        this.instructions_[this.zIndex + this.offset_].push(property, value);\n        return true;\n      }\n    });\n  }\n\n  /**\n   * @private\n   * @param {...*} args Args.\n   * @return {ZIndexContext} This.\n   */\n  pushMethodArgs_ = (...args) => {\n    this.instructions_[this.zIndex + this.offset_].push(args);\n    return this;\n  };\n\n  /**\n   * Push a function that renders to the context directly.\n   * @param {function(CanvasRenderingContext2D): void} render Function.\n   */\n  pushFunction(render) {\n    this.instructions_[this.zIndex + this.offset_].push(render);\n  }\n\n  /**\n   * Get a proxy for CanvasRenderingContext2D which does not support getting state\n   * (e.g. `context.globalAlpha`, which will return `undefined`). To set state, if it relies on a\n   * previous state (e.g. `context.globalAlpha = context.globalAlpha / 2`), set a function,\n   * e.g. `context.globalAlpha = (context) => context.globalAlpha / 2`.\n   * @return {ZIndexContextProxy} Context.\n   */\n  getContext() {\n    return this.context_;\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   */\n  draw(context) {\n    this.instructions_.forEach(instructionsAtIndex => {\n      for (let i = 0, ii = instructionsAtIndex.length; i < ii; ++i) {\n        const property = instructionsAtIndex[i];\n        if (typeof property === 'function') {\n          property(context);\n          continue;\n        }\n        const instructionAtIndex = instructionsAtIndex[++i];\n        if (typeof (/** @type {*} */context[property]) === 'function') {\n          /** @type {*} */context[property](...instructionAtIndex);\n        } else {\n          if (typeof instructionAtIndex === 'function') {\n            /** @type {*} */context[property] = instructionAtIndex(context);\n            continue;\n          }\n          /** @type {*} */\n          context[property] = instructionAtIndex;\n        }\n      }\n    });\n  }\n  clear() {\n    this.instructions_.length = 0;\n    this.zIndex = 0;\n    this.offset_ = 0;\n  }\n\n  /**\n   * Offsets the zIndex by the highest current zIndex. Useful for rendering multiple worlds or tiles, to\n   * avoid conflicting context.clip() or context.save()/restore() calls.\n   */\n  offset() {\n    this.offset_ = this.instructions_.length;\n    this.zIndex = 0;\n  }\n}\nexport default ZIndexContext;","map":{"version":3,"names":["getSharedCanvasContext2D","ZIndexContext","constructor","instructions_","zIndex","offset_","context_","Proxy","get","target","property","undefined","push","pushMethodArgs_","set","value","args","pushFunction","render","getContext","draw","context","forEach","instructionsAtIndex","i","ii","length","instructionAtIndex","clear","offset"],"sources":["/Users/komiljohn/TestTasks/osm-prosight-dev/openlayers-map-app/node_modules/ol/render/canvas/ZIndexContext.js"],"sourcesContent":["/**\n * @module ol/render/canvas/ZIndexContext\n */\n\nimport {getSharedCanvasContext2D} from '../../dom.js';\n\n/** @typedef {CanvasRenderingContext2D & {globalAlpha: any}} ZIndexContextProxy */\n\n/**\n * @extends {CanvasRenderingContext2D}\n */\nclass ZIndexContext {\n  constructor() {\n    /**\n     * @private\n     * @type {Array<Array<*>>}\n     */\n    this.instructions_ = [];\n    /**\n     * @type {number}\n     */\n    this.zIndex = 0;\n    /**\n     * @private\n     * @type {number}\n     */\n    this.offset_ = 0;\n\n    /**\n     * @private\n     * @type {ZIndexContextProxy}\n     */\n    this.context_ = /** @type {ZIndexContextProxy} */ (\n      new Proxy(getSharedCanvasContext2D(), {\n        get: (target, property) => {\n          if (\n            typeof (/** @type {*} */ (getSharedCanvasContext2D())[property]) !==\n            'function'\n          ) {\n            // we only accept calling functions on the proxy, not accessing properties\n            return undefined;\n          }\n          if (!this.instructions_[this.zIndex + this.offset_]) {\n            this.instructions_[this.zIndex + this.offset_] = [];\n          }\n          this.instructions_[this.zIndex + this.offset_].push(property);\n          return this.pushMethodArgs_;\n        },\n        set: (target, property, value) => {\n          if (!this.instructions_[this.zIndex + this.offset_]) {\n            this.instructions_[this.zIndex + this.offset_] = [];\n          }\n          this.instructions_[this.zIndex + this.offset_].push(property, value);\n          return true;\n        },\n      })\n    );\n  }\n\n  /**\n   * @private\n   * @param {...*} args Args.\n   * @return {ZIndexContext} This.\n   */\n  pushMethodArgs_ = (...args) => {\n    this.instructions_[this.zIndex + this.offset_].push(args);\n    return this;\n  };\n\n  /**\n   * Push a function that renders to the context directly.\n   * @param {function(CanvasRenderingContext2D): void} render Function.\n   */\n  pushFunction(render) {\n    this.instructions_[this.zIndex + this.offset_].push(render);\n  }\n\n  /**\n   * Get a proxy for CanvasRenderingContext2D which does not support getting state\n   * (e.g. `context.globalAlpha`, which will return `undefined`). To set state, if it relies on a\n   * previous state (e.g. `context.globalAlpha = context.globalAlpha / 2`), set a function,\n   * e.g. `context.globalAlpha = (context) => context.globalAlpha / 2`.\n   * @return {ZIndexContextProxy} Context.\n   */\n  getContext() {\n    return this.context_;\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   */\n  draw(context) {\n    this.instructions_.forEach((instructionsAtIndex) => {\n      for (let i = 0, ii = instructionsAtIndex.length; i < ii; ++i) {\n        const property = instructionsAtIndex[i];\n        if (typeof property === 'function') {\n          property(context);\n          continue;\n        }\n        const instructionAtIndex = instructionsAtIndex[++i];\n        if (typeof (/** @type {*} */ (context)[property]) === 'function') {\n          /** @type {*} */ (context)[property](...instructionAtIndex);\n        } else {\n          if (typeof instructionAtIndex === 'function') {\n            /** @type {*} */ (context)[property] = instructionAtIndex(context);\n            continue;\n          }\n          /** @type {*} */ (context)[property] = instructionAtIndex;\n        }\n      }\n    });\n  }\n\n  clear() {\n    this.instructions_.length = 0;\n    this.zIndex = 0;\n    this.offset_ = 0;\n  }\n\n  /**\n   * Offsets the zIndex by the highest current zIndex. Useful for rendering multiple worlds or tiles, to\n   * avoid conflicting context.clip() or context.save()/restore() calls.\n   */\n  offset() {\n    this.offset_ = this.instructions_.length;\n    this.zIndex = 0;\n  }\n}\n\nexport default ZIndexContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}